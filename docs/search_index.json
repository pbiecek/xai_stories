[
["index.html", "XAI Stories Preface", " XAI Stories 2020-04-23 Preface This book is the result of a student projects for Interpretable Machine Learning course at the University of Warsaw and the Warsaw University of Technology. Each team has prepared one case study for selected XAI technique. This project is inspired by a fantastic book Limitations of Interpretable Machine Learning Methods created at the Department of Statistics, LMU Munich. We used the LIML project as the cornerstone for this repository. The book chapters are written in the Markdown language. The simulations, data examples and visualizations were created with R (R Core Team 2018) and Python. The book was compiled with the bookdown package. We collaborated using github repository. Cover by kozaka93. Creative Commons License This book is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. References "],
["foreword.html", "Foreword 0.1 Why? 0.2 What? 0.3 How?", " Foreword Author: Przemyslaw Biecek (Warsaw University of Technology and University of Warsaw) 0.1 Why? Machine learning has a number of applications. Very often, however, machine learning predictive models are treated as black boxes which can be automatically trained without worrying about the domain in which they are used. This opaqueness rises many risks that are difficult to foresee during the model building process. Such as the model’s declining performance due to the data drift, poor performance on the out-of-domain problems or unfair biased behaviour learned on historical data. The growing list of examples where black boxes fail spectacularly has led to an increased interest in XAI methods. Such methods allow to x-ray black boxes models for more detailed analysis on the local or global level. According to Gartner Hype Cycle for Emerging Technologies in 2019 Explainable AI is on the verge of Innovation trigger and Peak of inflated expectations. It is a technology with a very high potential, which is talked about a lot in the media and which heats up the imagination as strongly as AI. In the literature there are many articles arguing the need to use XAI methods as well as many ideas for new methods from the XAI family. However, it is much more difficult to find examples of successful implementations of XAI methods that have improved the business. Missing elements are case studies of actual use of XAI methods in machine learning problems. Such case studies would allow a better understanding of what is possible today and what is not possible using XAI methods. 0.2 What? This ebook collects examples of the use of different methods from the XAI family for different real-world predictive problems. In the following chapters, we show example applications of different XAI techniques to problems based on real-world public dataset. These examples are called XAI stories and like every good story, each one has a structure. It starts with a description of the predictive problem, goes on to describe the proposed model or models. The models are x-rays using XAI techniques to finish the chapter with a point. 0.3 How? For XAI stories to be credible they need not only a strong predictive model, but also business validation of the proposed modeling and explanation approach. Each group of students got two mentors from McKinsey’s Data Science department. The mentors, together with the students, searched for strengths and weaknesses of XAI applications in specific problems. TODO: write more about this collaboration "],
["story-house-sale-prices.html", "Chapter 1 Story House Sale Prices: eXplainable predictions for house sale 1.1 Introduction 1.2 Model 1.3 Explanations 1.4 Summary and conclusions", " Chapter 1 Story House Sale Prices: eXplainable predictions for house sale Authors: Piotr Grązka (SGH Warsaw School of Economics), Anna Kozak (Warsaw University of Technology), Paweł Wicherek (Warsaw University of Technology) Mentors: Mateusz Zawisza (McKinsey &amp; Company), Adam Zmaczyński (McKinsey &amp; Company) ,,That’s all your house is: it’s a place to keep your stuff while you go out and get more stuff.’’ George Carlin 1.1 Introduction Everybody needs a roof over their heads. It can be a house, villa or a flat. Everybody, at some point of life, faces a choice if to buy a house. If so, which one. And why they are so expensive? Topic of real estates is not only the topic you just have to deal with. It can also be very interesting. There are plenty of TV Shows, for instance Property Brothers, of which plot is based on examples of people buying and renovating houses. This particular one is the most famous in the world and has been running already almost a decade. For many people houses are also products to buy and sell with income. Regardless of motives of buy/sell real estate, both sides agree to a price. It is always good to know, how much it is worth, what’s the fair/true value. And, maybe it’s even more important, why the price is like that, what has an influence on it. In this work we want to try to find an answer to both questions with stronger emphasis on the second one. This paper is intended to be a complete use cases how to deal with regression problem for Data Scientists. Let’s start with a couple of questions that will allow us to understand and define the problems The seller does not know how to increase the cost of the apartment so that the investment outlay is lower than the added value (e.g. building a pool will increase the price and renovating the bathroom is not worth it). The seller does not know how much to sell the apartment for (he makes an offer on the portal and does not know if the price is fair). The buyer does not know how much the apartment is worth (as above, whether the price is fair). Commercial problem: Auction services do not have tools to support sellers/buyers. These are just some of the questions we can ask. As a definition of our problem, we have set ourselves a property valuation, and through explanations we will try to get an answer depending on the position we choose. We have divided our work into several stages, below we present a diagram with a step plan. It allowed us to plan our work, and now we will use it to tell you what we did. We started our work with a literature review. Many works show a comparison of hedonistic models (linear regression) and machine learning models. Below there is a plot with comparison of results achieved by models interpretable by design (hedonistic) and black box model (ANN) based on the article @ref(house_prices). We can conclude that we reduce the interpretability to an increase in the quality of model fitting. The next point was data analysis, we work on dataset which contains house sale prices for King County, which includes Seattle. It is include homes sold between May 2014 and May 2015. Data available on kaggle and openml. We have analyzed the data. More link. Data contains 19 house features plus the price and the id columns, along with 21613 observations. id unique ID for each home sold date date of the home sale price price of each home sold bedrooms number of bedrooms bathrooms number of bathrooms, where .5 accounts for a room with a toilet but no shower sqft_living square footage of the apartments interior living space sqft_lot square footage of the land space floors sumber of floors waterfront apartment was overlooking the waterfront or not view how good the view of the property was condition condition of the apartment grade level of construction and design sqft_above the square footage of the interior housing space that is above ground level sqft_basement the square footage of the interior housing space that is below ground level yr_built the year the house was initially built yr_renovated the year of the house’s last renovation zipcode zipcode area lat lattitude long longitude sqft_living15 the square footage of interior housing living space for the nearest 15 neighbors sqft_lot15 the square footage of the land lots of the nearest 15 neighbors We have collected methods to evaluate the performance of the regression model, we decided to use RMSRE (root mean square relative errors), because the difference of 50 thousand on a property worth millions and 50 thousand on a property worth 200 thousand is quite considerable. More about measures link. Based on the literature we decided to test the following models: - fixed effects model - random effects model - Spatial Autoregressive (SAR) model - linear regression - decision tree - random forest - gradient boosting, xgboost Another idea how to enrich our solution was to add external data. The location of the property can significantly affect the price, so we also took into account the distance from public transport and the number of cultural facilities within a kilometre radius. 1.2 Model Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. 1.3 Explanations Here, show how XAI techniques can be used to solve the problem. Will dataset specific or instance specific techniques help more? Will XAI be useful before (pre), during (in) or after (post) modeling? What is interesting to learn from the XAI analysis? 1.4 Summary and conclusions Here add the most important conclusions related to the XAI analysis. What did you learn? Where were the biggest difficulties? What else did you recommend? "],
["story-hotel-booking.html", "Chapter 2 Story hotel booking: eXplainable predictions of booking cancelation and guests coming back 2.1 Introduction 2.2 Model 2.3 Explanations 2.4 Summary and conclusions", " Chapter 2 Story hotel booking: eXplainable predictions of booking cancelation and guests coming back Authors: Domitrz Witalis (MIM), Seweryn Karolina (MiNI) Mentors: Jakub Tyrek (Data Scientist), Aleksander Pernach (Consultant) 2.1 Introduction The dataset is downloaded from the Kaggle competition website https://www.kaggle.com/jessemostipak/hotel-booking-demand. This dataset contains booking information for a city hotel and a resort hotel in Portugal, and includes information such as when the booking was made, length of stay, the number of adults, children, babies, the number of available parking spaces, chosen meals, price etc. There are 32 features and 119 390 observations. The booking website has information about these reservation characteristics and building models can help this company in better offer management. The most important information could be the prediction of booking cancelation, the prediction if client comes back to the hotel, the prediction whether client orders additional services (eg. meals), customer segmentation. In this project, we have decided to focus on two first issues. 2.1.1 Hyperparameter optimization 2.1.2 Imbalanced dataset [Put a description of the problem here. indicate the data source. Describe why this problem is important. Indicate the most important literature on the problem.] 2.2 Model 2.2.1 Model 1. Booking cancelation The aim of this model is to predict whether guest cancels reservation and explanation of the reasons. The chosen model is XGBoost with RFE (Recursive Feature Elimination). Bayesian optimisation with TPE tuner has been applied in order to improve model performance. Neural Network Intelligence (NNI) package has been chosen for this task, because it provides user-friendly GUI with summary of experiments. List of optimized hyperparameters and search space: max_depth - the maximum depth of tree. n_esimators - the number of trees. learning_rate - boosting learning rate colsample_bytree - subsample ratio of columns when constructing each tree. Figure details paths of hyperparameters values chosen by algorithm. On the right you can see metric (AUC) of model with those parameters. Figure presents AUC for each experiment. It shows a clear trend in model performence so algorithm is choosing better and better hyperparameters. AUC train AUC test image 2.2.2 Model 2. Repeated guests Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. 2.3 Explanations 2.3.1 Model 1. Booking cancelation 2.3.1.1 dataset image . Figure above shows SHAP values. There are some interesting findings which are intuitive: Clients who canceled some reservations in the past are more likely to cancel another reservation. People who buy refundable option cancel reservations more often than others. A lot of days between reservation time and arrival time increases probability of cancelling booking. People who travel with children are more likely to cancel booking. There are also less intuitive findings: People without any special requests cancel reservetion more often than others. If trip starts at the end of the week there is higher probability that customers change their minds. The bigger number of adults, the highest probability of cancelation. 2.3.1.2 instance The lowest prediction of cancelation probability The highest prediction of cancelation probability 2.3.2 Model 2. Repeated guests Here, show how XAI techniques can be used to solve the problem. Will dataset specific or instance specific techniques help more? Will XAI be useful before (pre), during (in) or after (post) modeling? What is interesting to learn from the XAI analysis? 2.4 Summary and conclusions Here add the most important conclusions related to the XAI analysis. What did you learn? Where were the biggest difficulties? What else did you recommend? "],
["story-uplift-modelling.html", "Chapter 3 Story Uplift Modelling: eXplaining colon cancer survival rate after treatment 3.1 Introduction 3.2 Model 3.3 Explanations 3.4 Summary and conclusions", " Chapter 3 Story Uplift Modelling: eXplaining colon cancer survival rate after treatment Authors: Aleksandra Łuczak (Warsaw University of Technology), Tymoteusz Makowski (Warsaw University of Technology), Kateryna Shulikova (Warsaw School of Economics) Mentors: Miłosz Dobersztyn (McKinsey), Armin Reinert (McKinsey) 3.1 Introduction TODO(oryginał): Put a description of the problem here. indicate the data source. Describe why this problem is important. Indicate the most important literature on the problem. 3.1.1 What is Uplift Modelling? Czym jest uplift modelling? Gdzie go się stosuje? Jakie problemy możemy modelować (survival &amp; leki, marketing &amp; zysk)? 3.1.2 Dataset Description Opis naszego zbioru. Co na nim będziemy modelować (treatment a survival rate). Wstępne uzasadnienie dlaczego warto tym się zająć i dlaczego dobrze będzie tu cokolwiek wyjaśniać [ad 5]. 3.2 Model TODO(oryginał): Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. - Jaki model wybraliśmy? - Jak trzeba było przygotować dataset? - Jakie ma osiągi? - Jakieś miary typu F1, accuracy i opis tego, które miary na tym zbiorze powinno się stosować. 3.3 Explanations TODO:(oryginał): &gt; Here, show how XAI techniques can be used to solve the problem. &gt; Will dataset specific or instance specific techniques help more? &gt; &gt; Will XAI be useful before (pre), during (in) or after (post) modeling? &gt; &gt; What is interesting to learn from the XAI analysis? Jak w ogóle to wyjaśniać skoro np. możemy mieć dwa modele? Wizualizacje dopracować (czytelne wykresy, opisy itp.) [ad 4]. 3.3.1 Dataset Level Explainations Jaka jest istotność zmiennych? 3.3.2 Instance Level Explainations Jakieś “ciekawe” przypadki? 3.4 Summary and conclusions TODO:(oryginał): &gt; Here add the most important conclusions related to the XAI analysis. &gt; What did you learn? &gt; Where were the biggest difficulties? &gt; What else did you recommend? Jakich informacji XAI nam dostarczyło na temat tego problemu? Jak XAI sprawdza się do wyjaśniania upliftu? Dlaczego było warto to modelować (konkretnie ten dataset) [ad 5]. "],
["story-meps-healthcare-expenditures-of-individuals.html", "Chapter 4 Story MEPS: Healthcare expenditures of individuals 4.1 Introduction 4.2 Models", " Chapter 4 Story MEPS: Healthcare expenditures of individuals 4.1 Introduction In this part, models that predict annual healthcare expenditure of individuals will be developed and analyzed using XAI methods. The dataset used is called MEPS (Medical Expenditure Panel Survey) and it is freely accessible at [ref1]. The data comes from large-scale surveys of families, individuals, medical providers and employers from the United States of America. Each observation of the data set contains total expenditures of an individual as well as number of other variables describing his or her demographic and socio-economic status. This allows to create models predicting the expenditure based on other factors. For this reason it is particularly interesting from the point of view of the subject that is financially responsible for the healthcare cost – insurance company, government, healthcare provider or individuals. It is important to mention, that for all of these subjects, accurate model is only a part of the success – the other part are the relations between input parameters and predictions of the model. Having that we can provide an answer not only for how much? but also for why? Hopefully, this can be achieved with available XAI methods. The data analyzed in the following sections was not downloaded directly from MEPS website. Instead, it was obtained through IBM’s AIX360 [ref2]. Therefore it is initially preprocessed – race is restricted to black and white and ethnicity to non-Hispanic, records with special values (negative integers) are removed for some of the variables, variables are initially selected. The dataset provides 18350 observations and it contains variables that describe: demographics (age, gender, marital status), socio-economics (education, income, insurance coverage), self-reported health status (self-evaluation of physical and mental health status), diagnoses (stroke, cancer, heart disease, diabetes), health limitations (cognitive, activity, sensory). Since the distribution of the predicted variable is strongly skewed to the right, it was transformed with logarithm base 3. Typically in such cases, natural logarithm is chosen, but having in mind that impact of input variables on the prediction will be analyzed, the decision was made to use base 3 instead (when we see that some input variable affected the prediction increasing it by one, then we can say that it increased the total expenditures by the factor of three, not factor of Euler number). The following section describes the development of three different models for predicting the transformed total health expenditure of an individual. Once developed, these models are compared in terms of their quality and of them is selected and analyzed using XAI methods. Explanations provided by different methods are discussed. The baseline for this discussion was provided by the authors of IBM’s AIX360 [ref3]. 4.2 Models 4.2.1 Model 1: Linear 4.2.2 Model 2: ANN 4.2.3 Model 3: XGB 4.2.4 Working refs [ref1] https://www.meps.ahrq.gov/mepsweb/ [ref2] https://github.com/IBM/AIX360 [ref3] https://nbviewer.jupyter.org/github/IBM/AIX360/blob/master/examples/tutorials/MEPS.ipynb#data "],
["examples.html", "Examples", " Examples "],
["story-covid19.html", "Chapter 5 Story covid19: eXplainable predictions for mortality 5.1 Figures and citations 5.2 Introduction 5.3 Model 5.4 Explanations 5.5 Summary and conclusions", " Chapter 5 Story covid19: eXplainable predictions for mortality Authors: Author 1 (University 1), Author 2 (University 2), Author 3 (University 3) Mentors: Mentor 1 (Affiliation 1), Mentor 2 (Affiliation 2) 5.1 Figures and citations Cite other materials this way: This book is created with (Xie 2015). Refer to figures or chatpers this way: In Figure 5.1 we show a CC BY-NA-SA logo. The next chapter is 6. FIGURE 5.1: Licence: Creative Commons Attribution NonCommercial ShareAlike 5.2 Introduction Put a description of the problem here. indicate the data source. Describe why this problem is important. Indicate the most important literature on the problem. 5.3 Model Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. 5.4 Explanations Here, show how XAI techniques can be used to solve the problem. Will dataset specific or instance specific techniques help more? Will XAI be useful before (pre), during (in) or after (post) modeling? What is interesting to learn from the XAI analysis? 5.5 Summary and conclusions Here add the most important conclusions related to the XAI analysis. What did you learn? Where were the biggest difficulties? What else did you recommend? References "],
["story-lungs.html", "Chapter 6 Story lungs: eXplainable predictions for post operational risks 6.1 Introduction 6.2 Model 6.3 Explanations 6.4 Summary and conclusions", " Chapter 6 Story lungs: eXplainable predictions for post operational risks Authors: Author 1 (University 1), Author 2 (University 2), Author 3 (University 3) Mentors: Mentor 1 (Affiliation 1), Mentor 2 (Affiliation 2) Put a description of the problem here. indicate the data source. Describe why this problem is important. Indicate the most important literature on the problem. 6.1 Introduction 6.2 Model Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. 6.3 Explanations Here, show how XAI techniques can be used to solve the problem. Will dataset specific or instance specific techniques help more? Will XAI be useful before (pre), during (in) or after (post) modeling? What is interesting to learn from the XAI analysis? 6.4 Summary and conclusions Here add the most important conclusions related to the XAI analysis. What did you learn? Where were the biggest difficulties? What else did you recommend? "],
["story-compas.html", "Chapter 7 Story COMPAS: recidivism reloaded 7.1 Introduction 7.2 Model 7.3 Explanations 7.4 Summary and conclusions", " Chapter 7 Story COMPAS: recidivism reloaded Authors: Author 1 (University 1), Author 2 (University 2), Author 3 (University 3) Mentors: Mentor 1 (Affiliation 1), Mentor 2 (Affiliation 2) 7.1 Introduction Put a description of the problem here. indicate the data source. Describe why this problem is important. Indicate the most important literature on the problem. 7.2 Model Place a description of the model(s) here. Focus on key information on the design and quality of the model(s) developed. 7.3 Explanations Here, show how XAI techniques can be used to solve the problem. Will dataset specific or instance specific techniques help more? Will XAI be useful before (pre), during (in) or after (post) modeling? What is interesting to learn from the XAI analysis? 7.4 Summary and conclusions Here add the most important conclusions related to the XAI analysis. What did you learn? Where were the biggest difficulties? What else did you recommend? "],
["acknowledgements.html", "Chapter 8 Acknowledgements", " Chapter 8 Acknowledgements This project is inspired by a fantastic book Limitations of Interpretable Machine Learning Methods created at the Department of Statistics, LMU Munich. We used the LIML project as cornerstone for this reopsitory. "],
["references.html", "References", " References R Core Team. 2018. R: A Language and Environment for Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. https://www.R-project.org/. Xie, Yihui. 2015. Dynamic Documents with R and Knitr. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. http://yihui.name/knitr/. "]
]
